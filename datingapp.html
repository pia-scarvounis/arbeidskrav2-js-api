<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dating-app</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <h1>Velkommen til din datingapp</h1>
    <!-- container & counter -->
    <div id="personal-profile-container">
      <h2 id="profile-container">Min profil</h2>
      <div id="swipe-score-container">Swipescore: 10</div>
      <div id="liked-profiles-container">Profiler likt:</div>
    </div>

    <!--- knapper til dating-siden -->
    <div class="content-container">
      <button id="women-btn" class="btn">Women</button>
      <button id="men-btn" class="btn">Men</button>
      <button id="both-btn" class="btn">Men & Women</button>
    </div>

    <script>
      // knapper, containers & counters js:
      const womenBtn = document.getElementById("women-btn");
      const menBtn = document.getElementById("men-btn");
      const bothBtn = document.getElementById("both-btn");

      const profileContainer = document.getElementById("profile-container");
      let swipeScoreContainer = document.getElementById(
        "swipe-score-container"
      );
      const likedProfilesContainer = document.getElementById(
        "liked-profiles-container"
      );
      let swipeCounter = 10;
      let currentGender = "";
      let currentDisplayedUser = null // null sa chatGPT at jeg skulle legge til
  

      // fetching, try & catch:
      let randomUsers; // legge alle random users i denne variabelen senere. trenger jeg denne nå? finn ut av det
      async function fetchRandomUser(gender = "") {
        const url = `https://randomuser.me/api/?results=30&gender=${gender}`;
        const response = await fetch(url);
        const data = await response.json();
        return data.results;
      }

      // hjelpefunksjon som henter inn randomUsers og viser de frem.
      async function fetchAndShowUsers(gender = "") {
        try {
          const users = await fetchRandomUser(gender);
          displayUsers(users);
        } catch (error) {
          console.error(
            "Uh oh, something has gone wrong. Please tweet us @randomapi about the issue. Thank you.",
            error
          );
        }
      }

      // Vise random profiler:
      function displayUsers(users) {
        profileContainer.innerHTML = "";
        if (users.length > 0) {
          const randomIndex = Math.floor(Math.random() * users.length);
          const user = users[randomIndex];
          currentDisplayedUser = user;
          const profileDiv = document.createElement("div");
          profileDiv.className = "profile";

          // bakgrunnsfarge ulike kjønn:
          if (user.gender === "female") {
            profileDiv.style.backgroundColor = "#FFDAB9";
          } else if (user.gender === "male") {
            profileDiv.style.backgroundColor = "#AACE9C";
          }

          // users profilbilde:
          const image = document.createElement("img");
          image.src = user.picture.large;
          image.alt = "Profile Picture";
          profileDiv.appendChild(image);
          // users navn:
          const name = document.createElement("p");
          name.textContent = `Name: ${user.name.first} ${user.name.last}`;
          profileDiv.appendChild(name);
          // users location:
          const city = document.createElement("p");
          city.textContent = `Location: ${user.location.city}, ${user.location.country}`;
          profileDiv.appendChild(city);

          profileContainer.appendChild(profileDiv);
        }
      }

      // knapper funksjon og addEventListener:
      womenBtn.addEventListener("click", function () {
        currentGender = "female";
        fetchAndShowUsers(currentGender);
      });

      menBtn.addEventListener("click", function () {
        currentGender = "male";
        fetchAndShowUsers(currentGender);
      });
      bothBtn.addEventListener("click", function () {
        currentGender = "";
        fetchAndShowUsers(currentGender);
      });

      // piltaster
      document.addEventListener("keydown", async function (event) {
        if (event.key == "ArrowLeft") {
          swipeCounter--;
          swipeScoreContainer.innerHTML = `Min swipescore: ${swipeCounter}`;
          await fetchAndShowUsers(currentGender);
        } else if (event.key == "ArrowRight") {
          if (currentDisplayedUser) {
            likedProfiles.push(currentDisplayedUser);
            updateLikedProfilesDisplay();
          }
          swipeCounter--;
          swipeScoreContainer.innerHTML = `Min swipescore: ${swipeCounter}`;
          await fetchAndShowUsers(currentGender);
        }
      });

      // filtrere ut likte profiler og adde de på siden
      const likedProfiles = [];

      function updateLikedProfilesDisplay() {
        likedProfilesContainer.innerHTML = "Profiler likt:";
        likedProfiles.forEach(user =>  {
          const img = document.createElement("img");
          img.src = user.picture.large;
          img.style.width = "50px";
          img.style.height = "50px";
          img.style.margin = "5px";

          likedProfilesContainer.appendChild(img);
        })
      };
    </script>
  </body>
</html>
